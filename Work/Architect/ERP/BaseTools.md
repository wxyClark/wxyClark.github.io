# BaseTools基础工具集

## Helpers 数据处理帮助类

* 和数据库无交互的数据处理方法、算法按类型封装
> CacheHelper
> DatetimeHelper
> NumberHelper
> StringHelper
> ArrayHelper
> FileHelper
> XxxBusinessHelper
> ListHelper 数据集合补充公共数据的映射(如xx_code需要获取xx_name等，在系统内多个列表都需要处理，须封装)

## Excel导入

### 无模板的导入(不存在合并单元格，标准二维表)

### 有模板的导入(指定表格是指定数据)

## Excel导出

```danger
强烈建议对文件类型的数据导出链接 支持单独下载,不要在导出excel中处理文件(图片、压缩包、视频等)
```

### 无模板的导出(标准二维表，导出不合并单元格)

* 写通用导出类，入参：二维数据，二维行列配置[列名 => [key、title、列宽]]
> 列名可不配置，更灵活，通过 chr(index + 65) 得到列名，方便调整列顺序

### 有模板的导出(表头特殊处理||内容是标准二维表但是有单元格合并)

* 写【通用的模块数据处理方法】，入参：二维数据，二维行列配置[key => [列名start、列名end]]
* 导入模板 或 通过【通用的模块数据处理方法】处理表头
* 逐列写当前导出通用的列宽定义

### 特殊模板的导出(有单元格合并||有单元格内容过长需要特殊处理||有特殊格式的单元格)

* 写【通用的模块数据处理方法】
* 导入模板 或 通过【通用的模块数据处理方法】处理表头
* 遍历数据，针对特殊数据 做特殊处理

## 数据字典

### 常量数据字典
```tips
常量定义集中维护 方便查找，避免ES维护时因为字段注释太长导致报错

建立缓存更新机制，提升读取销量
```

* 层级数据  缓存，可分成多套：铺平、组装成树状结构、组装成父子结构 (如：地址、无限级分类)
* 流程类数据 区分版本号缓存，兼容多版本数据并行  (如：流转路径、触发规则)
* 标识类数据 通过静态方法读取缓存得到map (如：状态、类型、标签)