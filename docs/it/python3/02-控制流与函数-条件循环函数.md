# Python 控制流与函数：条件语句、循环与函数定义

## 一、条件语句

### 1.1 if 语句

```python
# 基本 if 语句
age = 18
if age >= 18:
    print("成年人")

# if-else 语句
score = 85
if score >= 60:
    print("及格")
else:
    print("不及格")

# if-elif-else 语句
score = 75
if score >= 90:
    print("优秀")
elif score >= 80:
    print("良好")
elif score >= 60:
    print("及格")
else:
    print("不及格")
```

### 1.2 条件表达式（三元运算符）

```python
# 三元运算符
age = 20
status = "成年人" if age >= 18 else "未成年人"
print(status)

# 嵌套三元运算符
score = 85
grade = "A" if score >= 90 else ("B" if score >= 80 else "C")
print(grade)
```

### 1.3 条件语句嵌套

```python
# 嵌套条件语句
age = 25
has_license = True

if age >= 18:
    if has_license:
        print("可以开车")
    else:
        print("需要先考驾照")
else:
    print("未成年，不能开车")
```

### 1.4 实际应用场景

```python
# 用户登录验证
username = "admin"
password = "123456"

if username == "admin" and password == "123456":
    print("登录成功")
elif username == "admin":
    print("密码错误")
else:
    print("用户名不存在")

# 购物车折扣计算
total_price = 500
discount = 0

if total_price >= 1000:
    discount = 0.2
elif total_price >= 500:
    discount = 0.1
elif total_price >= 200:
    discount = 0.05

final_price = total_price * (1 - discount)
print(f"原价：{total_price}，折扣：{discount*100}%，最终价格：{final_price:.2f}")
```

## 二、循环语句

### 2.1 for 循环

```python
# 遍历列表
fruits = ["apple", "banana", "orange"]
for fruit in fruits:
    print(fruit)

# 遍历字符串
text = "Python"
for char in text:
    print(char)

# 遍历字典
student = {"name": "张三", "age": 20, "major": "计算机"}
for key, value in student.items():
    print(f"{key}: {value}")

# 使用 range()
for i in range(5):
    print(i)  # 0, 1, 2, 3, 4

for i in range(1, 6):
    print(i)  # 1, 2, 3, 4, 5

for i in range(0, 10, 2):
    print(i)  # 0, 2, 4, 6, 8

# 遍历索引和元素
fruits = ["apple", "banana", "orange"]
for index, fruit in enumerate(fruits):
    print(f"索引 {index}: {fruit}")

# 同时遍历多个列表
names = ["张三", "李四", "王五"]
ages = [20, 25, 30]
for name, age in zip(names, ages):
    print(f"{name}: {age}岁")
```

### 2.2 while 循环

```python
# 基本 while 循环
count = 0
while count < 5:
    print(count)
    count += 1

# 无限循环（需要 break 退出）
while True:
    user_input = input("请输入 'quit' 退出：")
    if user_input == "quit":
        break

# 计算阶乘
n = 5
factorial = 1
i = 1
while i <= n:
    factorial *= i
    i += 1
print(f"{n}! = {factorial}")
```

### 2.3 循环控制语句

```python
# break 语句（跳出循环）
for i in range(10):
    if i == 5:
        break
    print(i)  # 0, 1, 2, 3, 4

# continue 语句（跳过当前迭代）
for i in range(10):
    if i % 2 == 0:
        continue
    print(i)  # 1, 3, 5, 7, 9

# else 子句（循环正常结束时执行）
for i in range(5):
    print(i)
else:
    print("循环正常结束")

# break 时 else 不执行
for i in range(5):
    if i == 3:
        break
    print(i)
else:
    print("这段不会执行")
```

### 2.4 嵌套循环

```python
# 打印乘法表
for i in range(1, 10):
    for j in range(1, i + 1):
        print(f"{j}x{i}={i*j}", end="\t")
    print()

# 查找二维列表中的元素
matrix = [
    [1, 2, 3],
    [4, 5, 6],
    [7, 8, 9]
]
target = 5
found = False
for row in matrix:
    for num in row:
        if num == target:
            print(f"找到目标数字 {target}")
            found = True
            break
    if found:
        break
```

### 2.5 实际应用场景

```python
# 统计文本中单词出现次数
text = "hello world hello python world python python"
words = text.split()
word_count = {}
for word in words:
    word_count[word] = word_count.get(word, 0) + 1
print(word_count)

# 找出列表中的最大值和最小值
numbers = [3, 1, 4, 1, 5, 9, 2, 6]
max_num = numbers[0]
min_num = numbers[0]
for num in numbers:
    if num > max_num:
        max_num = num
    if num < min_num:
        min_num = num
print(f"最大值：{max_num}，最小值：{min_num}")

# 斐波那契数列
n = 10
fib = [0, 1]
for i in range(2, n):
    fib.append(fib[i-1] + fib[i-2])
print(f"前{n}个斐波那契数：{fib}")

# 猜数字游戏
import random
target = random.randint(1, 100)
attempts = 0
while True:
    guess = int(input("猜一个1-100之间的数字："))
    attempts += 1
    if guess == target:
        print(f"恭喜你猜对了！用了{attempts}次")
        break
    elif guess < target:
        print("太小了")
    else:
        print("太大了")
```

## 三、函数定义

### 3.1 基本函数定义

```python
# 无参数函数
def greet():
    print("Hello, World!")

greet()

# 有参数函数
def greet_person(name):
    print(f"Hello, {name}!")

greet_person("张三")

# 有返回值函数
def add(a, b):
    return a + b

result = add(3, 5)
print(result)  # 8

# 多返回值函数
def get_info():
    name = "张三"
    age = 20
    return name, age

name, age = get_info()
print(f"姓名：{name}，年龄：{age}")
```

### 3.2 参数类型

```python
# 位置参数
def greet(name, greeting):
    print(f"{greeting}, {name}!")

greet("张三", "Hello")

# 关键字参数
greet(name="李四", greeting="Hi")

# 默认参数
def greet(name, greeting="Hello"):
    print(f"{greeting}, {name}!")

greet("王五")              # 使用默认值
greet("赵六", "Hi")        # 覆盖默认值

# 可变位置参数（*args）
def sum_all(*args):
    return sum(args)

print(sum_all(1, 2, 3))        # 6
print(sum_all(1, 2, 3, 4, 5))  # 15

# 可变关键字参数（**kwargs）
def print_info(**kwargs):
    for key, value in kwargs.items():
        print(f"{key}: {value}")

print_info(name="张三", age=20, city="北京")

# 混合使用
def func(a, b, *args, c=10, **kwargs):
    print(f"a={a}, b={b}, args={args}, c={c}, kwargs={kwargs}")

func(1, 2, 3, 4, c=20, d=30, e=40)
```

### 3.3 参数传递

```python
# 不可变类型（值传递）
def modify_int(x):
    x = 10
    print(f"函数内：x = {x}")

num = 5
modify_int(num)
print(f"函数外：num = {num}")  # 5（原值不变）

# 可变类型（引用传递）
def modify_list(lst):
    lst.append(4)
    print(f"函数内：lst = {lst}")

my_list = [1, 2, 3]
modify_list(my_list)
print(f"函数外：my_list = {my_list}")  # [1, 2, 3, 4]（原值改变）

# 避免修改原列表
def modify_list_copy(lst):
    lst = lst.copy()  # 创建副本
    lst.append(4)
    return lst

my_list = [1, 2, 3]
new_list = modify_list_copy(my_list)
print(f"原列表：{my_list}")    # [1, 2, 3]
print(f"新列表：{new_list}")    # [1, 2, 3, 4]
```

### 3.4 函数作用域

```python
# 局部变量与全局变量
x = 10  # 全局变量

def func():
    x = 20  # 局部变量
    print(f"函数内 x = {x}")

func()
print(f"函数外 x = {x}")  # 10

# 使用 global 关键字
y = 10

def modify_global():
    global y
    y = 20
    print(f"函数内 y = {y}")

modify_global()
print(f"函数外 y = {y}")  # 20

# 嵌套函数与 nonlocal
def outer():
    z = 10

    def inner():
        nonlocal z
        z = 20
        print(f"内层函数 z = {z}")

    inner()
    print(f"外层函数 z = {z}")

outer()
```

### 3.5 匿名函数（lambda）

```python
# 基本用法
add = lambda a, b: a + b
print(add(3, 5))  # 8

# 与内置函数结合使用
numbers = [1, 2, 3, 4, 5]
squared = list(map(lambda x: x**2, numbers))
print(squared)  # [1, 4, 9, 16, 25]

# 过滤
even_numbers = list(filter(lambda x: x % 2 == 0, numbers))
print(even_numbers)  # [2, 4]

# 排序
students = [
    {"name": "张三", "age": 20},
    {"name": "李四", "age": 18},
    {"name": "王五", "age": 22}
]
students.sort(key=lambda x: x["age"])
print(students)
```

### 3.6 递归函数

```python
# 阶乘
def factorial(n):
    if n == 0 or n == 1:
        return 1
    return n * factorial(n - 1)

print(factorial(5))  # 120

# 斐波那契数列
def fibonacci(n):
    if n <= 1:
        return n
    return fibonacci(n - 1) + fibonacci(n - 2)

print(fibonacci(10))  # 55

# 汉诺塔问题
def hanoi(n, source, target, auxiliary):
    if n == 1:
        print(f"将盘子从 {source} 移动到 {target}")
        return
    hanoi(n - 1, source, auxiliary, target)
    print(f"将盘子从 {source} 移动到 {target}")
    hanoi(n - 1, auxiliary, target, source)

hanoi(3, "A", "C", "B")
```

### 3.7 函数装饰器

```python
# 基本装饰器
def my_decorator(func):
    def wrapper():
        print("函数执行前")
        func()
        print("函数执行后")
    return wrapper

@my_decorator
def say_hello():
    print("Hello, World!")

say_hello()

# 带参数的装饰器
def timer(func):
    import time
    def wrapper(*args, **kwargs):
        start = time.time()
        result = func(*args, **kwargs)
        end = time.time()
        print(f"函数执行时间：{end - start:.4f}秒")
        return result
    return wrapper

@timer
def slow_function():
    import time
    time.sleep(1)
    return "完成"

print(slow_function())
```

### 3.8 生成器函数

```python
# 生成器函数
def count_down(n):
    while n > 0:
        yield n
        n -= 1

for num in count_down(5):
    print(num)  # 5, 4, 3, 2, 1

# 斐波那契数列生成器
def fibonacci_generator(n):
    a, b = 0, 1
    for _ in range(n):
        yield a
        a, b = b, a + b

for num in fibonacci_generator(10):
    print(num, end=" ")  # 0 1 1 2 3 5 8 13 21 34
```

### 3.9 实际应用场景

```python
# 数据验证函数
def validate_email(email):
    if "@" not in email:
        return False
    parts = email.split("@")
    if len(parts) != 2:
        return False
    if "." not in parts[1]:
        return False
    return True

print(validate_email("user@example.com"))  # True
print(validate_email("invalid-email"))      # False

# 数据处理管道
def process_data(data):
    def clean(text):
        return text.strip().lower()

    def tokenize(text):
        return text.split()

    def count_words(words):
        return len(words)

    cleaned = clean(data)
    tokens = tokenize(cleaned)
    return count_words(tokens)

text = "  Hello World Hello Python  "
print(process_data(text))  # 4

# 缓存装饰器
def memoize(func):
    cache = {}

    def wrapper(*args):
        if args not in cache:
            cache[args] = func(*args)
        return cache[args]
    return wrapper

@memoize
def fibonacci(n):
    if n <= 1:
        return n
    return fibonacci(n - 1) + fibonacci(n - 2)

print(fibonacci(100))  # 快速计算
```

## 四、常用内置函数

### 4.1 数学函数

```python
# 绝对值
print(abs(-5))  # 5

# 四舍五入
print(round(3.14159, 2))  # 3.14

# 幂运算
print(pow(2, 3))  # 8

# 最大值和最小值
print(max(1, 2, 3, 4, 5))  # 5
print(min(1, 2, 3, 4, 5))  # 1

# 求和
print(sum([1, 2, 3, 4, 5]))  # 15
```

### 4.2 类型转换函数

```python
# 类型转换
print(int("123"))      # 123
print(float("3.14"))   # 3.14
print(str(456))        # "456"
print(list("hello"))   # ['h', 'e', 'l', 'l', 'o']
print(tuple([1, 2, 3]))  # (1, 2, 3)
print(set([1, 2, 2, 3]))  # {1, 2, 3}
```

### 4.3 序列操作函数

```python
# 长度
print(len([1, 2, 3]))  # 3

# 排序
print(sorted([3, 1, 4, 1, 5]))  # [1, 1, 3, 4, 5]

# 反转
print(list(reversed([1, 2, 3])))  # [3, 2, 1]

# 枚举
for index, value in enumerate(["a", "b", "c"]):
    print(index, value)

# 压缩
names = ["张三", "李四", "王五"]
ages = [20, 25, 30]
for name, age in zip(names, ages):
    print(f"{name}: {age}岁")
```

### 4.4 高阶函数

```python
# map
numbers = [1, 2, 3, 4, 5]
squared = list(map(lambda x: x**2, numbers))
print(squared)  # [1, 4, 9, 16, 25]

# filter
even_numbers = list(filter(lambda x: x % 2 == 0, numbers))
print(even_numbers)  # [2, 4]

# reduce
from functools import reduce
total = reduce(lambda x, y: x + y, numbers)
print(total)  # 15
```

## 五、面试常考题

### 5.1 for 循环与 while 循环的区别

**问题：for 循环和 while 循环有什么区别？**

**答案：**
| 特性 | for 循环 | while 循环 |
|------|---------|-----------|
| 使用场景 | 已知循环次数 | 未知循环次数 |
| 控制方式 | 遍历序列 | 条件判断 |
| 风险 | 较少死循环 | 容易死循环 |
| 语法 | `for item in sequence:` | `while condition:` |

```python
# for 循环：遍历列表
for i in range(5):
    print(i)

# while 循环：条件控制
count = 0
while count < 5:
    print(count)
    count += 1
```

### 5.2 函数参数传递方式

**问题：Python 中函数参数是如何传递的？**

**答案：**
Python 使用"按对象引用传递"（call by object reference）：
- 不可变类型（int, str, tuple）：类似值传递
- 可变类型（list, dict, set）：类似引用传递

```python
# 不可变类型
def modify_int(x):
    x = 10

num = 5
modify_int(num)
print(num)  # 5（不变）

# 可变类型
def modify_list(lst):
    lst.append(4)

my_list = [1, 2, 3]
modify_list(my_list)
print(my_list)  # [1, 2, 3, 4]（改变）
```

### 5.3 递归与迭代的区别

**问题：递归和迭代有什么区别？**

**答案：**
| 特性 | 递归 | 迭代 |
|------|------|------|
| 实现方式 | 函数调用自身 | 循环结构 |
| 内存使用 | 较高（调用栈） | 较低 |
| 可读性 | 通常更清晰 | 有时较复杂 |
| 适用场景 | 树形结构、分治 | 线性结构 |

```python
# 递归实现阶乘
def factorial_recursive(n):
    if n <= 1:
        return 1
    return n * factorial_recursive(n - 1)

# 迭代实现阶乘
def factorial_iterative(n):
    result = 1
    for i in range(2, n + 1):
        result *= i
    return result
```

### 5.4 lambda 函数的优缺点

**问题：lambda 函数有什么优缺点？**

**答案：**
- **优点**：
  - 代码简洁
  - 适合简单操作
  - 与高阶函数配合良好

- **缺点**：
  - 只能包含一个表达式
  - 可读性较差
  - 不能包含语句
  - 调试困难

```python
# lambda 适合简单操作
add = lambda a, b: a + b

# 复杂逻辑应使用普通函数
def complex_operation(x, y):
    if x > 0:
        result = x + y
    else:
        result = x - y
    return result
```

## 六、总结

### 6.1 关键要点

1. **条件语句**：if, elif, else，支持嵌套
2. **循环语句**：for, while，支持 break, continue
3. **函数定义**：def 关键字，支持多种参数类型
4. **作用域**：局部、全局、嵌套作用域
5. **高级特性**：lambda、装饰器、生成器
6. **内置函数**：丰富的内置函数库

### 6.2 最佳实践

1. 保持函数简短，单一职责
2. 使用有意义的函数名和参数名
3. 避免过深的嵌套
4. 合理使用默认参数
5. 注意递归深度限制
6. 使用类型注解提高代码可读性

### 6.3 学习建议

1. 多练习条件语句和循环的组合使用
2. 理解函数参数传递机制
3. 掌握高阶函数的使用
4. 学习装饰器的原理和应用
5. 注意代码的可读性和可维护性
6. 多做算法题，提高编程能力
